#+TITLE:        PowerShell Get-Credential
#+AUTHOR:       scheatkode
#+EMAIL:        scheatkode@gmail.com
#+DESCRIPTION:  Getting PowerShell credentials on the command line
#+PROPERTY:     header-args :tangle no :comments link :results none

Usually  when using  the  ~Get-Credential~  cmdlet, a  GUI  dialog box  appears,
prompting for the credentials. This is  the "/Common Criteria Certified/" way of
handling credentials. It is  also a pain in the ass  at times, especially when
connecting  using   one  of  the  different   command-line  remote  management
utilities.  If the  necessary privileges  are provided,  this behavior  can be
altered to request the credentials via the command line.

#+begin_src powershell
$RegistryKey = "HKLM:\SOFTWARE\Microsoft\PowerShell\1\ShellIds"
Set-ItemProperty $RegistryKey ConsolePrompting True
#+end_src

Once this has been correctly executed,  ~Get-Credential~ will now prompt for the
credentials directly on the command line.
